#!/usr/bin/env bash
# Configure Nginx to have a custom 404 page

# Install Nginx if not already installed
if ! command -v nginx &> /dev/null; then
    apt-get update
    apt-get install -y nginx
fi

# Backup the default Nginx configuration
cp /etc/nginx/sites-available/default /etc/nginx/sites-available/default_backup

# Use sed to replace a line in the Nginx configuration
sed -i '/location \/ {/a \\terror_page 404 /404.html;\n\tlocation = /404.html {\n\t\troot /usr/share/nginx/html;\n\t\tinternal;\n\t}' /etc/nginx/sites-available/default

# Create a custom 404 page with the specified content
echo "Ceci n'est pas une page" | tee /usr/share/nginx/html/404.html > /dev/null

# Restart Nginx to apply the changes
service nginx restart
